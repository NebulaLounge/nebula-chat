<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NebulaLounge â€“ Connessione</title>
  <style>
    body, html {
      margin: 0; padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #0b132b;
      color: #f0e8de;
      min-height: 100vh;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #messageContainer {
      width: 100%;
      height: 90px; /* altezza fissa uguale al banner */
      padding: 16px;
      box-sizing: border-box;
      text-align: center;
      background: linear-gradient(to right, #001f3f, #142a4d, #001f3f);
      box-shadow: inset 0 0 22px #ea5906aa;
      color: #f0e8de;
      font-weight: 700;
      font-size: 1.7rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      transition: opacity 1s ease;
      overflow: hidden;
    }
    #userDetails {
      font-weight: 500;
      font-size: 1.1rem;
      margin-top: 6px;
      opacity: 0;
      transition: opacity 1s ease;
    }

    iframe.chat {
      border: none;
      width: 100vw;
      height: calc(100vh - 180px); /* altezza meno banner + messaggio (90+90) */
      display: block;
    }

    .frame-banner {
      display: none;
      justify-content: center;
      align-items: center;
      height: 90px;
      width: 100%;
      background: linear-gradient(to right, #001f3f, #0b132b, #001f3f);
      box-shadow: inset 0 0 22px rgba(234, 89, 6, 0.4);
    }

    .banner-bottom {
      width: 100%;
      height: 90px;
      margin-top: 16px;
      background: linear-gradient(to right, #001f3f, #0b132b, #001f3f);
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: inset 0 0 22px rgba(234, 89, 6, 0.4);
    }

    form { display: none; }
  </style>
</head>
<body>

<div class="container" aria-live="polite">
  <div id="messageContainer">
    <div id="mainMessage">ðŸ’¬ Connessione in corso...</div>
    <div id="userDetails"></div>
  </div>

  <!-- Form invisibile -->
  <form id="chatForm" action="https://entrainchat-01.simosnap.com/login.php" method="post" target="chatFrame" aria-hidden="true" tabindex="-1">
    <input type="hidden" name="nick" id="nickField" />
    <input type="hidden" name="password" id="passwordField" />
    <input type="hidden" name="channel" value="#NebulaLounge" />
    <input type="hidden" name="sex" id="sexField" />
    <input type="hidden" name="location" id="cityField" />
    <input type="hidden" name="gecos" value="NebulaLounge" />
  </form>

  <!-- Chat iframe -->
  <iframe class="chat" name="chatFrame" id="chatFrame" title="Chat NebulaLounge - Canale #NebulaLounge"></iframe>
</div>

<!-- Banner inferiore -->
<div class="banner-bottom" aria-label="Banner pubblicitario inferiore">
  <iframe
    src="https://rotator.tradetracker.net/?r=97208&t=iframe"
    width="728" height="90"
    style="border:0; margin:0; padding:0;"
    frameborder="0" scrolling="no"
    title="Banner pubblicitario inferiore NebulaLounge">
  </iframe>
</div>

<!-- Banner superiore (inizialmente nascosto) -->
<div class="frame-banner" id="bannerTop" aria-label="Banner pubblicitario superiore" style="display:none;">
  <iframe
    src="https://rotator.tradetracker.net/?r=97208&t=iframe"
    width="728" height="90"
    style="border:0; margin:0; padding:0;"
    frameborder="0" scrolling="no"
    title="Banner pubblicitario superiore NebulaLounge">
  </iframe>
</div>

<!-- Audio -->
<audio id="welcomeAudio" preload="auto" src="https://www.indelibile.it/wp-content/uploads/2025/07/simple-notification-152054.mp3"></audio>

<script>
  function capitalize(str) {
    return str
      ? str.split(" ").map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(" ")
      : "";
  }

  window.onload = function () {
    const nick = localStorage.getItem("nick") || "Guest";
    const sex = localStorage.getItem("sex") || "";
    const looking = localStorage.getItem("looking") || "";
    const city = localStorage.getItem("city") || "";
    const password = localStorage.getItem("password") || "";

    document.getElementById("nickField").value = nick;
    document.getElementById("sexField").value = sex;
    document.getElementById("cityField").value = city;
    document.getElementById("passwordField").value = password;

    const sexText     = sex === "M" ? "un ðŸ‘¨â€ðŸ’¼ Uomo â™‚ï¸" : sex === "F" ? "una ðŸ‘© Donna â™€ï¸" : "un* utente";
    const lookingText = looking === "M" ? "un ðŸ‘¨â€ðŸ’¼ Uomo â™‚ï¸" : looking === "F" ? "una ðŸ‘© Donna â™€ï¸" : "qualcuno";
    const cityText    = city ? `dalla cittÃ  di ðŸ“${capitalize(city)}` : "da una localitÃ  sconosciuta ðŸ•µï¸";

    const userDetails = `Ciao ${capitalize(nick)}, sei ${sexText} e stai cercando ${lookingText} ${cityText}.`;

    // Prepara elementi DOM
    const mainMessageEl = document.getElementById("mainMessage");
    const userDetailsEl = document.getElementById("userDetails");
    const bannerTop = document.getElementById("bannerTop");

    // 1) Mostra subito "Connessione in corso..."
    mainMessageEl.textContent = "ðŸ’¬ Connessione in corso...";
    userDetailsEl.style.opacity = "0";

    // 2) Dopo 5.5 secondi mostra messaggio di benvenuto con dettagli
    setTimeout(() => {
      mainMessageEl.textContent = "ðŸš€ Benvenuto nella NebulaLounge! Lasciati ispirare.";
      userDetailsEl.textContent = userDetails;
      userDetailsEl.style.opacity = "1";
    }, 5500);

    // 3) Invia form per aprire la chat dopo 2 secondi (subito)
    setTimeout(() => {
      document.getElementById("chatForm").submit();
    }, 2000);

    // 4) Riproduci audio a 11 secondi (circa)
    setTimeout(() => {
      const audio = document.getElementById("welcomeAudio");
      audio.play().catch(err => console.warn("Audio bloccato:", err));
    }, 11000);

    // 5) Dopo 60 secondi mostra banner superiore e nasconde messaggio
    setTimeout(() => {
      // Nascondi messaggio con fade out
      mainMessageEl.style.opacity = "0";
      userDetailsEl.style.opacity = "0";

      setTimeout(() => {
        mainMessageEl.style.display = "none";
        userDetailsEl.style.display = "none";

        // Mostra banner superiore
        bannerTop.style.display = "flex";
      }, 1000);
    }, 60000);
  };
</script>

</body>
</html>
