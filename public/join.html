<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NebulaLounge – Connessione</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #0b132b;
      color: #f0e8de;
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #welcomeStep1, #welcomeStep2 {
      width: 100%;
      padding: 16px;
      text-align: center;
      background: linear-gradient(to right, #001f3f, #142a4d, #001f3f);
      box-shadow: inset 0 0 22px #ea5906aa;
      transition: opacity 1s ease;
    }

    #welcomeStep1 .welcomeTitle,
    #welcomeStep2 .welcomeTitle {
      font-size: 2rem;
      font-weight: 700;
    }

    #welcomeStep2 .welcomeDetails {
      font-size: 1.1rem;
      font-weight: 500;
      display: none;
      margin-top: 8px;
    }

    #app {
      width: 100%;
      max-width: 1080px;
      height: 700px;
      margin-top: 16px;
      box-shadow: 0 0 14px rgba(0,0,0,0.4);
    }

    .banner-bottom {
      width: 100%;
      height: 90px;
      margin: 16px 0 0 0;
      background: linear-gradient(to right, #001f3f, #0b132b, #001f3f);
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: inset 0 0 22px rgba(234, 89, 6, 0.4);
    }
  </style>

  <!-- KiwiIRC scripts -->
  <script src="https://entrainchat-01.simosnap.com/static/js/chunk-vendors.bccfcc30.js" defer></script>
  <script src="https://entrainchat-01.simosnap.com/static/js/app.00480481.js" defer></script>
</head>
<body>

  <div class="container">
    <!-- 🌌 Step 1 -->
    <div id="welcomeStep1">
      <div class="welcomeTitle">🌌 Benvenuta/o – Connessione attiva. Inizia il viaggio su <strong>NebulaLounge</strong>!</div>
    </div>

    <!-- 🚀 Step 2 -->
    <div id="welcomeStep2" style="display: none;">
      <div class="welcomeTitle">🚀 Benvenuto nella <strong>NebulaLounge</strong>! Lasciati ispirare.</div>
      <div class="welcomeDetails" id="detailsArea"></div>
    </div>

    <!-- Chat -->
    <div id="app"></div>
  </div>

  <!-- Banner inferiore -->
  <div class="banner-bottom">
    <iframe
      src="https://rotator.tradetracker.net/?r=97208&amp;t=iframe"
      width="728" height="90"
      style="border:0; margin:0; padding:0;"
      frameborder="0" scrolling="no"
      title="Banner pubblicitario"></iframe>
  </div>

  <!-- Audio -->
  <audio id="welcomeAudio" preload="auto" src="https://www.indelibile.it/wp-content/uploads/2025/07/simple-notification-152054.mp3"></audio>

  <script>
    function capitalize(str) {
      return str
        ? str.split(" ").map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(" ")
        : "";
    }

    const nick     = localStorage.getItem("nick") || "Guest";
    const sex      = localStorage.getItem("sex") === "M" ? "un 👨‍💼 Uomo ♂️" : "una 👩 Donna ♀️";
    const looking  = localStorage.getItem("looking") === "F" ? "una 👩 Donna ♀️" : "un 👨‍💼 Uomo ♂️";
    const city     = localStorage.getItem("city") || "una località sconosciuta 🕵️";

    // Messaggio personalizzato
    document.getElementById("detailsArea").textContent =
      `Ciao ${capitalize(nick)}, sei ${sex} e stai cercando ${looking} dalla città di 📍${capitalize(city)}.`;

    // Saluto visivo
    setTimeout(() => {
      document.getElementById("welcomeStep1").style.opacity = "0";
      setTimeout(() => {
        document.getElementById("welcomeStep1").style.display = "none";
        document.getElementById("welcomeStep2").style.display = "block";
        document.querySelector(".welcomeDetails").style.display = "block";
      }, 1000);
    }, 7000);

    // Audio
    setTimeout(() => {
      document.getElementById("welcomeAudio").play().catch(err => {
        console.warn("Audio bloccato:", err);
      });
    }, 8000);

    // Configurazione KiwiIRC
    window.kiwiConfig = function () {
      return {
        windowTitle: "NebulaLounge – Webchat",
        kiwiServer: "https://kiwiirc.simosnap.com/webirc/kiwiirc/",
        nick: nick,
        channel: "#NebulaLounge",
        gecos: `Webchat – ${nick} da ${city}`,
        theme: "5Chat",
        plugins: [
          { name: "nickserv", url: "/plugins/plugin-nickserv.js" },
          { name: "emoji", url: "/plugins/plugin-emoji-prelim.min.js" },
          { name: "asl", url: "/plugins/plugin-asl.js" }
        ]
      };
    };
  </script>

</body>
</html>
